<!-- START CONTAINER FLUID -->
<div class="container-fluid container-fixed-lg bg-white">
    <!-- START PANEL -->
    <div class="panel panel-transparent">
        <div class="panel-body">
            <div class="panel">
                <button class="btn btn-success pull-right" id="btnToggleSlideUpSize" ng-click="showNewChallenge()">
                    <i class="fa fa-plus"></i> {{'challenge-button-new' | translate }}
                </button>
                <ul class="nav nav-tabs nav-tabs-simple" role="tablist">
                    <li ng-class="{'active': active==0}">
                        <a data-toggle="tab" pg-tab role="tab" ng-click="setActive(0)">{{'challenge-tab-new' | translate}}</a>
                    </li">
                    <li ng-class="{'active': active==1}">
                        <a data-toggle="tab" pg-tab role="tab" ng-click="setActive(1)">{{'challenge-tab-active' | translate}}</a>
                    </li>
                    <li ng-class="{'active': active==2}">
                        <a data-toggle="tab" pg-tab role="tab" ng-click="setActive(2)">{{'challenge-tab-successful' | translate}}</a>
                    </li>
                    <li ng-class="{'active': active==3}">
                        <a data-toggle="tab" pg-tab role="tab" ng-click="setActive(3)">{{'challenge-tab-failed' | translate}}</a>
                    </li>
                    <li ng-class="{'active': active==4}">
                        <a data-toggle="tab" pg-tab role="tab" ng-click="setActive(4)">{{'challenge-tab-pending' | translate}}</a>
                    </li>
                </ul>
            </div>
            <div class="table-responsive">
                <div class="table-responsive">
                    <table class="table table-hover table-condensed table-detailed" id="detailedTable" ui-options="options">
                    <thead>
                        <tr>
                            <th style="width:30%" translate>{{'challenge-table-th-challenge'}}</th>
                            <th style="width:20%" translate>{{'challenge-table-th-expires'}}</th>
                            <th style="width:20%" translate>{{'challenge-table-th-progress'}}</th>
                            <th style="width:15%" translate>{{'challenge-table-th-status'}}</th>
                            <th style="width:15%" translate>{{'challenge-table-th-action'}}</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr ng-repeat-start="i in challengeData | filter:{ status: active }" ng-click="expand($event)">
                            <td class="v-align-middle">
                                <challenge-title data="i"></challenge-title>
                            </td>

                            <td class="v-align-middle">
                                <p>{{formatDate(i.expires, "fromNow")}}</p>
                            </td>
                            <td class="v-align-middle">
                                <div>
                                    <p class="small hint-text">Your progress {{i.yourProgress}}%</p>
                                    <div class="progress">
                                        <div class="progress-bar bg-success" style="width:{{i.yourProgress}}%"></div>
                                    </div>
                                </div>
                                <div ng-if="i.assignee">
                                    <p class="small hint-text">Opponent progress {{i.opponentProgress}}%</p>
                                    <div class="progress">
                                        <div class="progress-bar bg-warning" style="width:{{i.opponentProgress}}%"></div>
                                    </div>
                                </div>
                            </td>
                            <td class="v-align-middle" ng-show="i.status==0">
                                New
                            </td>
                            <td class="v-align-middle" ng-show="i.status==0">
                                <button class="btn btn-success btn-cons" ng-click="challengeAccept(i.id)">Accept</button>
                            </td>
                            <td class="v-align-middle" ng-show="i.status==1">
                                In Progress
                            </td>
                            <td class="v-align-middle" ng-show="i.status==1">
                                <button class="btn btn-danger btn-cons" ng-click="challengeAbort(i.id)">Abort</button>
                            </td>
                            <td class="v-align-middle" ng-show="i.status==2">
                                <p>Successful</p>
                            </td>
                            <td class="v-align-middle" ng-show="i.status==3">
                                <p>Failed</p>
                            </td>
                            <td class="v-align-middle" ng-show="i.status==4">
                                <p>Pending</p>
                            </td>
                            <td class="v-align-middle" ng-show="i.status==4">
                                <button class="btn btn-danger btn-cons" ng-click="challengeAbort(i.id)">Cancel</button>
                            </td>
                        </tr>
                        <!--DETAILED INFO ABOUT CHALLENGE-->
                        <tr class="row-details" ng-repeat-end style="display:none">
                            <td colspan=4>
                                <p> Expires: {{formatDate(i.expires, "full")}} </p>
                                <p ng-if="i.opponent"> Assigned by: {{i.assignee}} </p>
                                <p> Fee: {{i.fee}} coins </p>
                                <p> Rewards: {{i.reward.coins}} coins and {{i.reward.points}} points </p>
                                <p> Already accepted by: {{i.acceptedby.join()}} </p>
                            </td>
                        </tr>
                        <!--END OF DETAILED INFO ABOUT CHALLENGE-->
                        
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    <!-- END PANEL -->
</div>
<!-- END CONTAINER FLUID -->

<!--MODAL-->
<div class="modal fade slide-up disable-scroll" id="newChallengeModal" tabindex="-1" role="dialog" aria-hidden="false">
    <div class="modal-dialog ">
        <div class="modal-content-wrapper">
            <div class="modal-content">
                <div class="modal-header clearfix text-left">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true"><i class="pg-close fs-14"></i>
                    </button>
                    <h5>New Challenge</h5>
                    <p class="p-b-10">We need information about your new challenge.</p>
                </div>
                <div class="modal-body">
                    <form role="form" novalidate>
                        <div class="form-group-attached">
                            <div class="row">
                                <div class="col-sm-12">
                                    <div class="form-group">
                                        <label>Challenge type</label>
                                        <!--<span class="help">Select new challenge type</span>-->
                                        <br/>
                                        <ui-select class="form-control" ng-model="newChallenge.challengeType" theme="select2" search-enabled="false" disabled required>
                                            <ui-select-match placeholder="Select challenge type...">{{newChallenge.challengeType.value}}</ui-select-match>
                                            <ui-select-choices repeat="(id, type) in newChallengeData.type">     
                                                {{'ChallengeType'+type.value | translate}}
                                            </ui-select-choices>
                                        </ui-select>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-sm-12">
                                    <div class="form-group">
                                        <label>Product Type</label>
                                        <br/>
                                        <ui-select class="form-control" ng-model="newChallenge.productType" theme="select2" search-enabled="false" required>
                                            <ui-select-match placeholder="Select challenge product type...">{{newChallenge.productType.value}}</ui-select-match>
                                            <ui-select-choices repeat="(id, type) in newChallengeData.product">
                                                {{'ChallengeType'+type.value | translate}}
                                            </ui-select-choices>
                                        </ui-select>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-sm-12">
                                    <div class="form-group" required>
                                        <label>Amount</label>
                                        <input type="text" name="productAmount" class="form-control" ng-model="newChallenge.productAmount" required>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-sm-12">
                                    <div class="form-group">
                                        <label>Challenge Target</label>
                                        <br/>
                                        <ui-select class="form-control" ng-model="newChallenge.challengeTarget" theme="select2" search-enabled="false" required>
                                            <ui-select-match placeholder="Select challenge target...">{{newChallenge.challengeTarget.value}}</ui-select-match>
                                            <ui-select-choices repeat="(id, type) in newChallengeData.target">
                                                {{type.value}}
                                            </ui-select-choices>
                                        </ui-select>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-sm-12">
                                    <div class="form-group">
                                        <label>End Date</label>
                                        <br/>
                                        <div id="datepicker-component" class="input-group date col-sm-8 p-l-0" ui-jq="datepicker" ng-model="newChallenge.challengeEnd" required>
                                            <input type="text" class="form-control" ng-model="newChallenge.endDate"><span class="input-group-addon"><i class="fa fa-calendar"></i></span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-sm-12">
                                    <div class="form-group">
                                        <label>Your bid</label>
                                        <input type="text" class="form-control" ng-model="newChallenge.bid" required>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </form>
                    <div class="row">
                        <div class="col-sm-6">
                            <div class="p-t-20 clearfix p-l-10 p-r-10">
                                <div class="pull-left">
                                    <p class="bold font-montserrat text-uppercase"></p>
                                </div>
                                <div class="pull-right">
                                    <p class="bold font-montserrat text-uppercase"></p>
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-3 m-t-10 sm-m-t-10">
                            <button data-dismiss="modal" type="button" class="btn btn-success btn-block m-t-5" ng-click="createChallenge()" ng-disabled="!isChallengeValid()">Create</button>
                        </div>
                        <div class="col-sm-3 m-t-10 sm-m-t-10">
                            <button data-dismiss="modal" type="button" class="btn btn-danger btn-block m-t-5">Cancel</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- /.modal-content -->
    </div>
</div>
<!--END MODAL-->

